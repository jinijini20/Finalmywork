Source URL: https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko

이 페이지는 Cloud Translation API [https://cloud.google.com/translate/?hl=ko]를 통해 번역되었습니다.
홈 [https://developers.google.com/?hl=ko]
제품 [https://developers.google.com/products?hl=ko]
Google Maps Platform [https://developers.google.com/maps?hl=ko]
문서 [https://developers.google.com/maps/documentation?hl=ko]
의견 보내기
Google Maps Platform Monitoring
Cloud Monitoring은 API 및 서비스, 사용자가 이용하는 Google Cloud 리소스의 측정항목을 수집합니다. 이 주제에서는 Cloud Monitoring을 구성하는 방법 및 Cloud Monitoring을 사용하여 API 사용량을 모니터링하고 대시보드와 알림을 만드는 방법을 설명합니다.
Cloud Monitoring에는 다양한 기능과 옵션이 있습니다. 이 주제에서는 Cloud Monitoring을 소개하고 기본 예시를 제공합니다. 더 많은 예시를 비롯한 전체 기능에 대한 자세한 내용은 Cloud Monitoring [https://cloud.google.com/monitoring/docs/monitoring-overview?hl=ko] 문서를 참고하세요.
Cloud Monitoring 구성하기
Monitoring을 사용하면 측정항목을 확인하고 관리할 수 있습니다.
단일 프로젝트
단일 조직 내 여러 프로젝트
여러 조직의 여러 프로젝트
프로젝트의 측정항목을 사용할 수 있도록 하려면 다음 단계를 따르세요.
Google Cloud 콘솔에서 Monitoring을 선택합니다.
Monitoring으로 이동 [https://console.cloud.google.com/monitoring?hl=ko]
알맞은 프로젝트를 선택했는지 확인합니다.
Monitoring 탐색창에서 측정항목 범위 오른쪽의 >를 클릭합니다. 다음 스크린샷은 AllEnvironments 프로젝트를 선택할 때 표시되는 페이지를 보여줍니다.
이 프로젝트에서 모니터링하는 측정항목이라고 라벨이 지정된 표에는 현재 측정항목 범위에 액세스할 수 있는 측정항목이 있는 프로젝트가 표시됩니다. 표의 각 행에는 프로젝트 및 해당 프로젝트의 역할이 표시됩니다.
범위 지정 프로젝트: 개발자가 구성하는 업타임 체크, 알림 정책, 그룹, 대시보드를 저장하는 프로젝트입니다. 측정항목 범위와 범위 지정 프로젝트 사이에는 1:1 관계가 있습니다. 이 예시에서는 AllEnvironments 프로젝트가 범위 지정 프로젝트입니다.
모니터링되는 프로젝트: 현재 측정항목 범위에 측정항목이 표시되는 프로젝트입니다. 이 예시에서는 Staging 프로젝트와 Production 프로젝트를 모니터링합니다.
아래 표시된 프로젝트에서 이 프로젝트의 측정항목 확인 가능이라고 라벨이 지정된 표에는 측정항목 범위에 현재 프로젝트를 포함하는 프로젝트가 표시됩니다. 위 스크린샷은 다른 어떤 프로젝트도 AllEnvironments 프로젝트가 저장한 측정항목에 액세스할 수 없음을 보여줍니다.
프로젝트를 추가하고 삭제하는 방법을 비롯한 자세한 내용은 Cloud Monitoring 구성하기 [https://cloud.google.com/monitoring/settings?hl=ko]를 참고하세요.
측정항목 살펴보기
측정항목 데이터를 탐색하려면 Cloud Monitoring에 포함된 측정항목 탐색기를 사용하여 차트를 만듭니다. 예를 들어 API의 할당량 사용량을 보려면 측정항목 탐색기를 사용하여 최신 데이터를 표시하는 차트를 구성하면 됩니다.
다음 이미지는 지도 API의 할당량 사용량을 자세히 설명하는 차트를 보여줍니다.
이 예시는 각 API를 막대의 각 섹션으로 표현한 누적 막대 그래프입니다. 선 차트, 막대 그래프, 히트맵 등 다양한 차트 유형을 만들 수 있습니다. 최대 10개의 측정항목을 표시하는 단일 차트를 만들 수도 있습니다.
이 이미지에서 설명하는 내용은 다음과 같습니다.
차트 왼쪽의 리소스 유형 및 측정항목 필드는 차트에 표시되는 측정항목 데이터를 정의합니다.
차트 위에 있는 차트 유형 드롭다운에서 차트 유형을 선택할 수 있습니다. 이 예시에서는 누적 막대 그래프로 설정되어 있습니다.
차트 위에 있는 시간 간격은 1주(1주일)로 설정되어 있습니다.
차트 아래에 차트의 데이터를 정의하는 서비스, quota_metrics, API 메서드, 측정항목 값이 표시됩니다. 이 정보를 사용하여 표시된 데이터를 세부적으로 조정하려면 필터 추가를 선택합니다.
측정항목 탐색기 페이지를 벗어나면 차트가 삭제되므로 원치 않아 삭제할 아티팩트가 없습니다. 또는 차트를 맞춤 대시보드에 저장하거나 공유할 수 있습니다. 대시보드에 차트를 추가하는 방법에 대한 자세한 내용은 아래의 대시보드 만들기 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#create-dashboards]를 참고하세요.
단일 측정항목을 표시하는 차트 작성
측정항목 탐색기를 사용하여 차트를 구성하려면 다음 안내를 따르세요.
Cloud Console에서 Monitoring을 선택합니다.
Monitoring으로 이동 [https://console.cloud.google.com/monitoring?hl=ko]
탐색창에서 측정항목 탐색기를 선택합니다.
툴바의 차트 유형 드롭다운에서 누적 막대 그래프를 선택하여 측정항목 데이터를 막대 그래프로 확인합니다.
1주(1주일) 등 시간 간격을 선택합니다.
차트에 표시될 데이터를 지정합니다. 메뉴 기반 인터페이스를 사용하거나 필터를 입력하려면 구성 탭을 선택합니다. 모니터링 쿼리 언어(MQL)를 사용하려면 MQL 탭을 선택합니다.
참고: MQL은 Cloud Monitoring 시계열 데이터에 텍스트 기반의 표현식 인터페이스를 제공합니다. 이 주제의 예시에서는 모두 Cloud 콘솔을 사용합니다. 자세한 내용은 모니터링 쿼리 언어 소개 [https://cloud.google.com/monitoring/mql?hl=ko]를 참고하세요.
할당량 사용량을 차트로 표시하려면 리소스 유형으로 소비자 할당량을 선택합니다. 또는 API 사용량에 대한 차트를 만들려면 사용한 API 또는 Google 지도 API를 선택합니다(Google Maps Platform API에 사용할 수 있는 사용량 측정항목에 대한 자세한 내용은 사용량 측정항목 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-usage-metrics]을 참고하세요). 각 리소스 유형 위로 마우스를 가져가면 해당 설명이 표시됩니다.
측정항목으로는 비율 할당량 사용량을 선택합니다. 차트가 자동으로 업데이트되어 측정항목 데이터를 표시합니다.
참고: 차트에 데이터가 표시되지 않는 경우 시간 간격을 늘리거나 차트를 종료한 후 여러 API 요청을 실행하여 측정항목 데이터를 생성합니다.
측정항목에는 다른 할당량 옵션도 있습니다. 각 측정항목 위로 마우스를 가져가면 설명이 표시됩니다. 측정항목 탐색기 필드에 대한 자세한 내용은 측정항목 선택하기 [https://cloud.google.com/monitoring/charts/metrics-selector?hl=ko]와 차트 데이터 표시 방법 선택하기 [https://cloud.google.com/monitoring/charts/metrics-selector?hl=ko#select_display]를 참고하세요.
(선택사항) 다음 옵션을 사용하여 데이터 표시를 세부적으로 조정합니다.
표시할 데이터의 하위 집합을 지정하려면 필터를 추가합니다. 필터를 추가하려면 필터 추가를 선택하고 대화상자를 작성합니다. 자세한 내용은 차트 데이터 필터링 [https://cloud.google.com/monitoring/charts/metrics-selector?hl=ko#filter-option]을 참고하세요. 예를 들어 단일 API의 데이터를 보려면 다음 안내를 따르세요.
라벨 필드에서 메서드를 선택합니다.
비교 필드에서 =(같음)을 선택합니다.
값 필드에서 특정 메서드의 이름을 선택합니다. 표시할 데이터가 있는 메서드의 이름을 선택하라는 메시지가 표시됩니다.
완료를 선택하여 차트를 업데이트합니다.
라벨별로 시계열을 그룹화하려면 그룹화 기준 필드를 사용합니다. 이 필드의 값을 선택하면 애그리게이터 필드의 값이 자동으로 선택됩니다.
시계열을 조합하는 방법을 지정하려면 애그리게이터 필드를 설정합니다. 예를 들어 그룹화 기준 필드가 비어 있고 애그리게이터 필드가 평균으로 설정된 경우 차트에 시계열의 평균이 표시됩니다.
개별 시계열을 처리하는 방법을 구성하려면 고급 옵션을 선택합니다. 자세한 내용은 측정항목 탐색기 사용 시 측정항목 선택하기 [https://cloud.google.com/monitoring/charts/metrics-selector?hl=ko#filter-option]를 참고하세요.
원하는 경우 대시보드에 추가합니다.
측정항목 탐색기 페이지에서 벗어나면 차트가 삭제됩니다. 필요에 따라 차트 저장을 선택하여 차트를 새 대시보드 또는 기존 대시보드에 저장할 수 있습니다. 대시보드에 차트를 추가하는 방법에 대한 자세한 내용은 아래의 대시보드 만들기 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#create-dashboards]를 참고하세요.
여러 측정항목을 표시하는 차트 작성
경우에 따라 동일한 차트에 여러 측정항목을 표시할 수 있습니다. 예를 들어 할당량 사용량을 표시하는 차트에 할당량 한도를 표시할 수 있습니다. 차트 한 개에 최대 10개의 측정항목을 표시할 수 있습니다.
기존 차트에 측정항목을 추가하려면 다음 안내를 따르세요.
기존 차트에서 화면 하단에 있는 다른 측정항목 추가를 선택합니다.
측정항목을 선택한 다음 해당 측정항목의 시계열을 표시하는 방법을 지정합니다. 위에서 기존 측정항목을 구성한 것과 같은 방식으로 지정할 수 있습니다.
관련 리소스
측정항목 탐색에 대한 자세한 내용은 다음을 참고하세요.
측정항목 탐색기로 차트 만들기 [https://cloud.google.com/monitoring/charts/metrics-explorer?hl=ko]
측정항목 탐색기 사용 시 측정항목 선택하기 [https://cloud.google.com/monitoring/charts/metrics-selector?hl=ko]
모든 Google Cloud API에서 사용할 수 있는 측정항목 [https://cloud.google.com/monitoring/api/metrics_gcp?hl=ko#gcp-serviceruntime]
Google Maps Platform API 고유의 측정항목 [https://cloud.google.com/monitoring/api/metrics_gcp?hl=ko#gcp-maps]
차트 분포 측정항목 [https://cloud.google.com/monitoring/charts/charting-distribution-metrics?hl=ko]
보기 옵션 [https://cloud.google.com/monitoring/charts/chart-view-options?hl=ko]
대시보드 만들기
대시보드를 사용하면 차트 모음에서 시계열 데이터를 확인하고 모니터링할 수 있습니다. Cloud Monitoring은 사전 정의된 대시보드와 맞춤 대시보드를 지원합니다.
사전 정의된 대시보드는 사용 중인 Google Cloud 서비스에 맞게 자동으로 설치됩니다. 이 경우 대시보드를 구성할 수 없습니다.
맞춤 대시보드는 내가 만드는 대시보드입니다. 맞춤 대시보드를 사용하면 확인하려는 데이터와 데이터를 확인하는 방법을 정의할 수 있습니다. 예를 들어 측정항목 데이터, 알림 정책, 프로젝트에 저장된 로그를 표시할 수 있습니다. 시계열 데이터는 차트, 게이지나 스코어카드, 표 형식으로 표시할 수 있습니다.
Cloud 콘솔 또는 Cloud Monitoring API를 사용하여 맞춤 대시보드를 만들 수 있습니다. 다음 이미지는 차트 두 개가 있는 맞춤 대시보드를 보여줍니다.
왼쪽: 할당량 차트
오른쪽: API 사용량 차트
측정항목 차트를 만든 후 대시보드에 차트를 추가하여 맞춤 대시보드를 만듭니다. 측정항목 탐색기에서 차트를 만든 다음 새 대시보드 또는 기존 대시보드에 추가할 수 있습니다. 또는 대시보드를 만든 다음 대시보드를 수정하여 차트를 추가할 수도 있습니다.
Cloud Monitoring API [https://cloud.google.com/monitoring/docs/apis?hl=ko]를 사용하여 맞춤 대시보드를 관리하려면 측정항목 탐색기에서 다음의 두 가지 유용한 유틸리티를 제공합니다.
대시보드에 추가할 차트를 JSON 형식으로 표현하려면 측정항목 탐색기로 차트를 구성하세요. 그런 다음 측정항목 탐색기 툴바의 more_vert 옵션 더보기 메뉴 항목에서 JSON 형식에 액세스할 수 있습니다.
Cloud Monitoring API에서 사용되는 Monitoring 필터의 구문을 식별하려면 측정항목 탐색기의 메뉴 기반 인터페이스를 사용하여 차트를 구성하세요. 측정항목과 필터를 선택한 후 직접 필터링 모드 [https://cloud.google.com/monitoring/charts/metrics-selector?hl=ko#metric-filter]로 전환하면 해당하는 Monitoring 필터를 볼 수 있습니다.
맞춤 대시보드 만들기
맞춤 대시보드를 만들려면 다음 안내를 따르세요.
Cloud Console에서 Monitoring을 선택합니다.
Monitoring으로 이동 [https://console.cloud.google.com/monitoring?hl=ko]
탐색창에서 대시보드를 선택합니다.
대시보드 개요 페이지에서 대시보드 만들기를 클릭합니다.
참고: 기존 대시보드를 수정하는 경우 수정 모드인지 확인하세요. 오른쪽 상단에 수정이 표시되지 않으면 보기를 클릭하고 수정 모드로 전환을 선택합니다.
대시보드에 추가하려는 각 차트에 대해 다음을 실행합니다.
차트 추가에서 차트 유형을 선택하거나 라이브러리에서 그래프 영역으로 차트 유형을 드래그합니다.
선택한 유형의 사전 구성된 차트가 표시됩니다. 다음 예시는 선 차트와 구성 창을 보여줍니다.
참고: 차트에 데이터가 표시되지 않는 경우 시간 간격을 늘리거나 차트를 종료한 후 여러 API 요청을 실행하여 측정항목 데이터를 생성합니다.
리소스 유형 및 측정항목을 선택하고 차트를 만들 때와 마찬가지로 필터를 적용합니다.
선택할 수 있는 항목에 대한 자세한 내용은 대시보드 위젯 추가 [https://cloud.google.com/monitoring/charts?hl=ko]를 참고하세요.
(선택사항) 대시보드 툴바에서 차트 추가를 클릭하여 다른 차트를 추가한 후 이전 단계를 반복하여 차트를 맞춤설정합니다.
수정이 완료되면 왼쪽 화살표를 선택하여 대시보드를 나가거나 다른 Monitoring 메뉴 항목을 선택합니다. 대시보드는 자동으로 저장됩니다.
대시보드 보기
대시보드를 보려면 다음 안내를 따르세요.
Cloud Console에서 Monitoring을 선택합니다.
Monitoring으로 이동 [https://console.cloud.google.com/monitoring?hl=ko]
탐색창에서 대시보드를 선택합니다.
목록에서 맞춤 대시보드 또는 사전 정의된 대시보드를 선택합니다.
관련 리소스
대시보드 만들기에 대한 자세한 내용은 다음을 참고하세요.
대시보드 및 차트 [https://cloud.google.com/monitoring/dashboards?hl=ko]
Console에서 맞춤 대시보드 관리 [https://cloud.google.com/monitoring/charts/dashboards?hl=ko]
API별 대시보드 관리 [https://cloud.google.com/monitoring/dashboards/api-dashboard?hl=ko]
사용량 측정항목
Google Maps Platform API의 사용량을 모니터링하는 데는 대부분의 Google Cloud API [https://console.cloud.google.com/apis/library?hl=ko]와 Google Maps Platform 측정항목 [https://cloud.google.com/monitoring/api/metrics_gcp?hl=ko#gcp-maps]에 사용할 수 있는 Serviceruntime 측정항목 [https://cloud.google.com/monitoring/api/metrics_gcp?hl=ko#gcp-serviceruntime](리소스 유형 consumed_api [https://cloud.google.com/monitoring/api/resources?hl=ko#tag_consumed_api])과 Google Maps Platform API 관련 측정항목(리소스 유형 maps.googleapis.com/Api [https://cloud.google.com/monitoring/api/resources?hl=ko#tag_maps.googleapis.com/Api])의 두 가지 측정항목 그룹을 사용할 수 있습니다.
두 측정항목 모두 API 사용 트래픽을 분할하기 위한 동일한 리소스 라벨인 project_id, service, method, version, location, credential_id를 지원합니다. 해당 측정항목 리소스에 대한 문서에서 리소스 라벨에 대한 설명을 확인하세요.
Serviceruntime 측정항목 리소스 라벨 [https://cloud.google.com/monitoring/api/resources?hl=ko#tag_consumed_api]
Google Maps Platform 리소스 라벨 [https://cloud.google.com/monitoring/api/resources?hl=ko#tag_maps.googleapis.com/Api]
각 측정항목 그룹에는 사용량 모니터링을 위해 요청 수와 요청 지연 시간이라는 두 가지 측정항목 유형이 있습니다.
요청 수 측정항목에서는 protocol, grpc_status_code, response_code, response_code_class 측정항목 라벨별로 사용 트래픽을 분할할 수 있습니다. 또한 Google Maps Platform 측정항목에서 platform_type별로 분할할 수 있습니다.
요청 지연 시간 측정항목에서는 Google Maps Platform 측정항목에서만 protocol, platform_type, response_code, response_code_class 측정항목 라벨별로 사용 트래픽을 분할할 수 있습니다.
측정항목 유형 및 라벨에 대한 자세한 내용은 해당 측정항목 그룹의 문서를 참고하세요.
Serviceruntime 측정항목 [https://cloud.google.com/monitoring/api/metrics_gcp?hl=ko#gcp-serviceruntime]
Google Maps Platform 측정항목 [https://cloud.google.com/monitoring/api/metrics_gcp?hl=ko#gcp-maps]
응답 상태 및 응답 코드 라벨 매핑
아래 표에서는 Google Maps Platform API 요청에 대한 응답으로 반환되는 응답 상태 코드 및 HTTP 응답 코드와 Cloud Monitoring에서 제공되는 응답 코드 라벨(HTTP 응답 코드, HTTP 응답 코드 클래스, GRPC 상태 코드 [https://github.com/googleapis/googleapis/blob/master/google/rpc/code.proto]) 간의 매핑을 보여줍니다. GRPC 상태 코드 [https://github.com/googleapis/googleapis/blob/master/google/rpc/code.proto]는 gRPC 요청의 경우 숫자로 된 gRPC 응답 코드, HTTP 요청의 경우 gRPC와 동일한 코드입니다.
참고: 기록상의 목적으로 Google Maps Platform API 요청에 대한 응답으로 반환되는 HTTP 응답 코드는 사용량 보고서(Google Maps Platform 측정항목 [https://developers.google.com/maps/reporting-and-monitoring/reporting?hl=ko#google-maps-metrics]) 및 Cloud Monitoring(Google Maps Platform Monitoring [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko])의 HTTP 응답 코드와 다를 수 있습니다. 사용량 보고서의 측정항목은 최신 API에서 사용되는 응답 코드 값과 일치하는 응답 코드 값의 집합을 사용합니다. 따라서 Google Maps Platform 측정항목 [https://developers.google.com/maps/reporting-and-monitoring/reporting?hl=ko#google-maps-metrics] 및 Google Maps Platform Monitoring [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko]에서 API 사용의 관측 가능성이 개선됩니다.
API 응답으로 반환된 응답 코드 모니터링에 보고된 응답 코드
지도 API 상태 HTTP 응답 코드 HTTP 응답 코드 HTTP 응답 코드 클래스 GRPC 상태 코드
OK 200,
204,
302 200,
204,
302 2xx,
3xx 0 (OK)
DATA_NOT_AVAILABLE,
NOT_FOUND,
ZERO_RESULTS 200 200, 404(1 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-codes-reports-fn1]) 2xx,
4xx(1 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-codes-reports-fn1]) 5 (NOT_FOUND)(1 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-codes-reports-fn1])
INVALID_REQUEST(잘못된 매개변수 값),
MAX_ROUTE_LENGTH_EXCEEDED,
MAX_WAYPOINTS_EXCEEDED,
등 200,
400 400 4xx 3 (INVALID_ARGUMENT)
INVALID_REQUEST(잘못된 매개변수/매개변수 누락, 요청 파싱 오류) 200,
400 400 4xx 3 (INVALID_ARGUMENT)
REQUEST_DENIED 200, 403,
200, 400 403,
401(1 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-codes-reports-fn1]) 4xx(1 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-codes-reports-fn1]) 7 (PERMISSION_DENIED),
16 (UNAUTHENTICATED)
OVER_DAILY_LIMIT,
OVER_QUERY_LIMIT,
RESOURCE_EXHAUSTED,
dailyLimitExceeded,
rateLimitExceeded,
userRateLimitExceeded 200,
403,
429 429(1 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-codes-reports-fn1]) 4xx(1 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-codes-reports-fn1]) 8 (RESOURCE_EXHAUSTED)
UNKNOWN_ERROR 200, 500,
503 500(1 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-codes-reports-fn1]),
503 5xx(1 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-codes-reports-fn1]) 2 (UNKNOWN)/13 (INTERNAL)(1 [https://developers.google.com/maps/reporting-and-monitoring/monitoring?hl=ko#monitoring-codes-reports-fn1]),
14 (UNAVAILABLE)
1 오류 코드 보고의 일관성을 개선하기 위해 Google Maps Platform API는 1) 지도 API 상태 DATA_NOT_AVAILABLE, NOT_FOUND, ZERO_RESULTS의 경우(상태 [https://issuetracker.google.com/issues/254811291?hl=ko]) HTTP 응답 코드/클래스 200/2xx에서 404/4xx로(GRPC 상태 코드를 0(OK)에서 5(NOT_FOUND)로), 2) 지도 API 상태 REQUEST_DENIED의 경우 HTTP 응답 코드/클래스 200/2xx, 400/4xx에서 403/4xx(및 GRPC 상태 코드 7(PERMISSION_DENIED))로, 3) 지도 API 상태 REQUEST_DENIED의 경우 HTTP 응답 코드/클래스 200/2xx, 403/4xx에서 401/4xx(GRPC 상태 코드 16(UNAUTHENTICATED))로, 4) 지도 API 상태 OVER_QUERY_LIMIT, dailyLimitExceeded, rateLimitExceeded, userRateLimitExceeded의 경우 HTTP 응답 코드/클래스 200/2xx, 403/4xx에서 429/4xx로, 5) 지도 API 상태 UNKNOWN_ERROR의 경우 HTTP 응답 코드/클래스 200/2xx에서 500/5xx(및 GRPC 상태 코드 2(UNKNOWN), 13(INTERNAL))로 이전합니다. 전환 기간에는 두 응답 코드를 모두 확인할 수 있습니다. 지도 API 응답으로 반환된 응답 코드는 변경되지 않습니다. 시간 경과에 따라 보고된 응답 코드의 세부정보는 측정항목 탐색기 [https://console.cloud.google.com/project/_/monitoring/metrics-explorer?pageState=%7B%22xyChart%22%3A%7B%22dataSets%22%3A%5B%7B%22timeSeriesFilter%22%3A%7B%22filter%22%3A%22metric.type%3D%5C%22maps.googleapis.com%2Fservice%2Frequest_count%5C%22+resource.type%3D%5C%22maps.googleapis.com%2FApi%5C%22%22%2C%22minAlignmentPeriod%22%3A%2260s%22%2C%22aggregations%22%3A%5B%7B%22perSeriesAligner%22%3A%22ALIGN_RATE%22%2C%22crossSeriesReducer%22%3A%22REDUCE_SUM%22%2C%22alignmentPeriod%22%3A%2260s%22%2C%22groupByFields%22%3A%5B%22metric.label.%5C%22response_code%5C%22%22%2C%22metric.label.%5C%22response_code_class%5C%22%22%2C%22resource.label.%5C%22service%5C%22%22%5D%7D%2C%7B%22perSeriesAligner%22%3A%22ALIGN_NONE%22%2C%22crossSeriesReducer%22%3A%22REDUCE_NONE%22%2C%22alignmentPeriod%22%3A%2260s%22%2C%22groupByFields%22%3A%5B%5D%7D%5D%7D%2C%22targetAxis%22%3A%22Y1%22%2C%22plotType%22%3A%22LINE%22%7D%5D%2C%22options%22%3A%7B%22mode%22%3A%22COLOR%22%7D%2C%22constantLines%22%3A%5B%5D%2C%22timeshiftDuration%22%3A%220s%22%2C%22y1Axis%22%3A%7B%22label%22%3A%22y1Axis%22%2C%22scale%22%3A%22LINEAR%22%7D%7D%2C%22isAutoRefresh%22%3Atrue%2C%22timeSelection%22%3A%7B%22timeRange%22%3A%221w%22%7D%7D&hl=ko]에서 확인할 수 있습니다.
알림 만들기
알림 [https://cloud.google.com/monitoring/alerts?hl=ko]을 사용하면 애플리케이션의 문제를 적시에 파악할 수 있으므로 문제를 신속하게 해결할 수 있습니다. Cloud Monitoring에서 알림 정책은 알림을 받을 상황과 방법을 설명합니다.
알림 정책은 단순할 수도 있고 복잡할 수도 있습니다. 알림 정책을 사용하면 단일 시계열로 조건을 충족할 수 있는지 또는 조건을 충족하려면 여러 시계열이 조건에 부합해야 하는지를 개발자가 구성할 수 있습니다. 예를 들면 다음과 같습니다.
특정 API의 요청 수가 5분 동안 1,000회를 초과하면 개발자에게 알립니다.
HTTP 200 응답의 90번째 백분위수가 3개 이상의 API에 대해 100ms의 지연 시간을 초과하면 긴급 대기 팀에 알립니다.
다음 이미지는 5분 동안 API 요청 수가 20개를 초과하면 알림을 생성하는 알림 정의를 보여줍니다.
이 이미지에서 설명하는 내용은 다음과 같습니다.
차트에는 시간 경과에 따른 여러 API의 API 호출 수가 표시됩니다.
빨간색 선은 알림 기준점을 표시합니다. 5분 동안 이 기준점을 초과하는 API 호출은 알림을 트리거합니다. 이 예시에서는 API 하나가 기준점을 초과했음을 알 수 있습니다.
알림 정책의 조건이 충족되면 Cloud Monitoring이 이슈를 시작하고 알림을 전송합니다.
이슈는 조건이 충족될 때 모니터링 리소스에 대한 정보를 저장하는 영구 레코드입니다. 조건이 더 이상 충족되지 않으면 이슈가 자동으로 종료됩니다. 알림 대시보드를 사용하여 모든 이슈(진행 중인 이슈 및 종결된 이슈 모두 포함)를 확인할 수 있습니다.
알림 정책을 구성할 때 알림을 받을 사람을 지정합니다. Monitoring은 이메일, Cloud Mobile App, PagerDuty 또는 Slack과 같은 서비스를 비롯한 일반적인 알림 채널을 지원합니다. 알림 채널의 전체 목록은 알림 옵션 [https://cloud.google.com/monitoring/support/notification-options?hl=ko]을 참고하세요.
알림 유형
Cloud Monitoring은 다양한 유형의 알림을 지원합니다. 예를 들어 다음을 정의할 수 있습니다.
측정항목 기준점 알림 [https://cloud.google.com/monitoring/alerts/types-of-conditions?hl=ko#metric-threshold]: 측정항목이 특정 기간 [https://cloud.google.com/monitoring/alerts/concepts-indepth?hl=ko#duration] 동안 일정 값을 초과하거나 그 아래로 떨어지는 경우, 또는 측정항목이 사전 정의된 비율만큼 증가하거나 감소하면 알림을 트리거합니다.
예산 알림 [https://cloud.google.com/billing/docs/how-to/budgets?hl=ko]: 설정된 규칙에 따라 비용(실제 비용 또는 예상 비용)이 예산의 일정 비율을 초과할 때 알림을 트리거하도록 기준점 규칙을 설정합니다. 이 알림은 API 사용량을 제한하지 않으며 지출액이 지정된 금액에 근접할 때 알림을 보내기만 합니다.
할당량 알림 [https://cloud.google.com/monitoring/alerts/using-quota-metrics?hl=ko]: Google Cloud는 프로젝트 또는 조직에서 사용하는 리소스를 추적하고 제한하는 데 사용할 수 있는 다양한 할당량을 설정합니다. 사용량이 할당량 한도에 가까워지면 알림을 보냅니다.
자세한 내용은 알림 정책 유형 [https://cloud.google.com/monitoring/alerts/types-of-conditions?hl=ko]을 참고하세요.
알림 정책 관리
Cloud 콘솔 또는 Cloud Monitoring API를 사용하여 프로젝트에 알림 정책을 추가할 수 있습니다. 프로젝트의 측정항목 기준 알림 정책 목록을 보는 방법과 이러한 정책을 수정하는 방법에 대한 자세한 내용은 다음을 참고하세요.
Cloud 콘솔을 사용하여 알림 정책 관리 [https://cloud.google.com/monitoring/alerts/using-alerting-ui?hl=ko]
Cloud Monitoring API를 사용하여 알림 정책 관리 [https://cloud.google.com/monitoring/alerts/policies-in-api?hl=ko]
알림 만들기
알림을 만들면 다음을 하게 됩니다.
측정항목 데이터를 기준으로 알림을 트리거하는 조건을 정의합니다.
알림을 받게 될 알림 채널을 정의합니다.
아래 예시는 모든 API의 Google Maps Platform 서비스 사용량이 5분 동안 요청 2회를 초과하는 경우 알림을 트리거하도록 설정하는 방법을 보여줍니다.
참고: 이 예시에서는 알림을 트리거할 수 있는 방법을 쉽게 보여주기 위해 API 요청 수를 적게 설정했습니다.
알림을 만들려면 다음 안내를 따르세요.
Cloud Console에서 Monitoring을 선택합니다.
Monitoring으로 이동 [https://console.cloud.google.com/monitoring?hl=ko]
알림을 선택합니다.
알림을 실행하는 방법을 정의하려면 알림 채널 수정을 선택합니다. 이 예에서는 이메일 주소를 사용합니다.
이메일 채널에서 새로 추가를 선택합니다.
이메일 주소 및 표시 이름을 입력합니다.
저장을 선택합니다.
알림을 선택합니다.
정책 만들기를 선택합니다.
시간 간격(예: 7일)을 선택합니다.
알림 조건에서 새 조건을 선택합니다.
측정항목 선택을 클릭하고 리소스로 사용한 API를 선택, 측정항목으로 요청 수를 선택한 후 적용을 선택합니다.
참고:요청 수가 측정항목 목록에 표시되지 않으면 종료한 후 여러 API 요청을 실행합니다. 측정항목에 대한 기존 데이터가 없으면 측정항목을 선택할 수 없습니다.
(선택사항) 차트 아래에 서비스, quota_metrics, API 메서드, 측정항목, 값이 표시됩니다. 이 정보를 기준으로 데이터를 필터링하려면 필터 추가를 선택합니다. 예를 들어 알림을 트리거하려면 메서드가 google.places.Autocomplete.http와 같아야 한다는 것을 정의하기 위해 필터를 사용할 수 있습니다.
데이터 변환에서 롤링 윈도우로 5분을 선택하고 롤링 윈도우 함수로 평균을 선택합니다.
다음을 선택합니다.
알림 트리거 구성에서 기준값을 2로 설정하면 5분 동안 요청이 2개를 초과할 때 알림을 트리거하도록 지정합니다. 이제 차트에 선택한 시간 간격의 알림 한도를 나타내는 빨간색 선이 표시됩니다. 차트에서 알림이 트리거된 위치를 확인할 수 있습니다. 이 차트를 사용하여 필요에 따라 한도를 조정할 수 있습니다.
다음을 클릭합니다.
알림 구성 및 알림 완료 페이지에서 다음을 실행합니다.
알림 채널용으로 만든 이메일 주소를 선택합니다.
알림 이름 지정에서 내 테스트 알림을 입력합니다.
정책 만들기를 선택합니다.
API 요청을 합니다. 이메일 알림을 보내려면 5분 이내에 3개 이상의 API 요청을 해야 합니다.
알림 이메일을 받으면 알림 페이지로 이동합니다.
알림이 표시된 표에서 해당 알림을 클릭하여 자세한 정보를 볼 수 있습니다.
알림 이름을 클릭하면 알림을 트리거한 이벤트가 표시된 차트를 포함한 알림 정보를 볼 수 있습니다.
관련 리소스
알림에 대한 자세한 내용은 다음을 참고하세요.
알림 소개 [https://cloud.google.com/monitoring/alerts?hl=ko]
예산 및 예산 알림 생성, 수정, 삭제 [https://cloud.google.com/billing/docs/how-to/budgets?hl=ko]
일반적인 알림 정책 설정 [https://cloud.google.com/monitoring/alerts/target-configuration-library?hl=ko]
할당량 측정항목 차트 생성 및 모니터링 [https://cloud.google.com/monitoring/alerts/using-quota-metrics?hl=ko]
의견 보내기